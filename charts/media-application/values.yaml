cluster:
  top_level_domain: example.com
  name: openshift
  admin_email: admin@example.com
  timezone: &timezone America/New_York

application:
  name: app
  group: Media
  icon: simple-icons:app
  image: https://raw.githubusercontent.com/app/app/develop/Logo/400.png
  description: "A tool for managing stuff."
  port: 8080

storage:
  storageClassName: synology-iscsi
  media:
    nfs:
      server: nas
      path: /volume1/media

image:
  # renovate: docker-image versioning=loose
  repository: &imageRepository ghcr.io/onedr0p/app
  tag: &imageTag 1.0.0.0000
  pullPolicy: &pullPolicy IfNotPresent

## Define app-template parameters based on the values above

app-template:
  controllers:
    main:
      type: statefulset
      annotations:
        reloader.stakater.com/auto: "true"
      labels:
        kasten/backup: "true"
      containers:
        main:
          image:
            # renovate: docker-image versioning=loose
            repository: *imageRepository
            tag: *imageTag
            pullPolicy: *pullPolicy
          env:
            TZ: *timezone

  serviceAccount:
    name: "{{ tpl .Values.application.name . | lower }}-sa"

  service:
    main:
      controller: main
      ports:
        http:
          port: "{{ tpl .Values.application.port . }}"

  persistence:
    config:
      enabled: true
      existingClaim: "{{ tpl .Values.application.name . | lower }}-config"

    data:
      enabled: true
      existingClaim: "{{ tpl .Values.application.name . | lower }}-data-volume"
      globalMounts:
        - path: /data

  defaultPodOptions:
    labels:
      app: "{{ tpl .Values.application.name . | lower }}"
      version: 1.0.0
    securityContext:
      runAsUser: 568
      runAsGroup: 568
      fsGroup: 568
      fsGroupChangePolicy: "OnRootMismatch"
      supplementalGroups:
        - 44
        - 109
        - 100
        - 65535
